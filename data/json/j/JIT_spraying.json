{"cursor":"4138","size":15,"audio":[],"currentlang":"en","article":"\n'JIT spraying' is a class of computer security exploit that circumvents the\nprotection of address space randomization (ASLR) and data execution prevention\n(DEP) by exploiting the behavior of just-in-time compilation. It has\nbeen reported to have been used to penetrate security features in the PDF format\n and Adobe's Flash technology.\n\nA Just-in-time compiler (JIT) by definition produces code as its data. Since the\npurpose is to produce executable data, a JIT compiler is one of the few types of\nprograms that cannot be run in a no-executable-data environment. Because of\nthis, JIT compilers are normally exempt from data execution prevention. A JIT\nspray attack does heap spraying with the generated code.\n\nTo produce exploit code from JIT, an idea from Dion Blazakis (BHDC-2010 ; ) is used. The input program, typically JavaScript or\nActionScript, typically contains numerous constant values that can be\nerroneously executed as code. For example, the XOR operation could be used: [http://dsecrg.com/pages/pub/show.php?id=22 Writing JIT-Spray\nShellcode for fun and profit], Alexey Sintsov, (pdf)\n\n var a=(0x11223344^0x44332211^0x44332211^ ...)\n\nJIT then will transform bytecode to native x86 code like:\n\n : b8 44 33 22 11 mov $0x11223344,%eax mov eax,0x11223344\n 5:  35 11 22 33 44 xor $0x44332211,%eax xor eax,0x44332211\n a:  35 11 22 33 44 xor $0x44332211,%eax xor eax,0x44332211\n\nThe attacker then uses a suitable bug to redirect code execution into the newly\ngenerated code. For example, a buffer overflow or use after free bug could allow\nthe attack to modify a function pointer or return address.\n\nThis causes the CPU to execute instructions in a way that was unintended by the\nJIT authors. The attacker is usually not even limited to the expected\ninstruction boundaries; it is possible to jump into the middle of an intended\ninstruction to have the CPU interpret it as something else. As with non-JIT ROP\nattacks, this may be enough operations to usefully take control of the computer.\nContinuing the above example, jumping to the second byte of the \"mov\"\ninstruction results in an \"inc\" instruction:\n\n 1:  44 inc %esp inc esp\n 2:  33 22 xor (%edx),%esp xor esp,DWORD PTR [edx]\n 3:  11 35 11 22 33 44 adc %esi,0x44332211 adc DWORD PTR ds:0x44332211,esi\n a:  35 11 22 33 44 xor $0x44332211,%eax xor eax,0x44332211\n\nComputer hardware that allows jumping into the middle of an instruction includes\nx86, x86-64, and ARM. Although especially effective on this type of hardware,\nJIT spraying works on other systems as well.\n\nTo protect against JIT spraying, the JIT code can be disabled or made less\npredictable for the attacker.\n","linknr":116,"url":"JIT_spraying","recorded":1374862477,"links":["/w/index.php?title=JIT_spraying&action=edit","/w/index.php?title=JIT_spraying&action=edit","//bits.wikimedia.org/favicon/wikipedia.ico","/w/opensearch_desc.php","//en.wikipedia.org/w/api.php?action=rsd","//creativecommons.org/licenses/by-sa/3.0/","/w/index.php?title=Special:RecentChanges&feed=atom","//bits.wikimedia.org/en.wikipedia.org/load.php?debug=false&lang=en&modules=ext.gadget.DRN-wizard%2CReferenceTooltips%2Ccharinsert%2Cteahouse%7Cext.rtlcite%2Cwikihiero%7Cext.uls.nojs%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmw.PopUpMediaTransform%7Cskins.vector&only=styles&skin=vector&*","//bits.wikimedia.org/en.wikipedia.org/load.php?debug=false&lang=en&modules=site&only=styles&skin=vector&*","//bits.wikimedia.org/en.wikipedia.org/load.php?debug=false&lang=en&modules=startup&only=scripts&skin=vector&*","//bits.wikimedia.org/geoiplookup","//meta.wikimedia.org","#mw-navigation","#p-search","/wiki/Computer_security_exploit","/wiki/Address_space_randomization","/wiki/Data_execution_prevention","/wiki/Just-in-time_compilation","#cite_note-1","/wiki/PDF","#cite_note-2","/wiki/Adobe_Flash","#cite_note-3","/wiki/Just-in-time_compiler","/wiki/Heap_spraying","#cite_note-bhdc10-4","/wiki/JavaScript","/wiki/ActionScript","/wiki/XOR","#cite_note-dsecrg-5","/wiki/Buffer_overflow","/w/index.php?title=Use_after_free&action=edit&redlink=1","/wiki/Function_pointer","/wiki/Return_address","/wiki/Return-oriented_programming","/wiki/X86","/wiki/X86-64","/wiki/ARM_architecture","#cite_note-bhdc10-4","/w/index.php?title=JIT_spraying&action=edit&section=1","#cite_ref-1","http://www.h-online.com/security/features/Return-of-the-sprayer-exploits-to-beat-DEP-and-ASLR-1171463.html","#cite_ref-2","http://web.archive.org/web/20100418191105/http://blog.fortinet.com/jit-spraying-in-pdf/","#cite_ref-3","http://blogs.pcmag.com/securitywatch/2010/02/new_jit_spray_penetrates_best.php","#cite_ref-bhdc10_4-0","#cite_ref-bhdc10_4-1","http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf","http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Slides-v2.pdf","#cite_ref-dsecrg_5-0","http://dsecrg.com/pages/pub/show.php?id=22","/wiki/File:Monitor_padlock.svg","//upload.wikimedia.org/wikipedia/commons/thumb/7/73/Monitor_padlock.svg/40px-Monitor_padlock.svg.png","/wiki/Computer_security","/wiki/Wikipedia:Stub","//en.wikipedia.org/w/index.php?title=JIT_spraying&action=edit","/wiki/Template:Computer-security-stub","/w/index.php?title=Template_talk:Computer-security-stub&action=edit&redlink=1","//en.wikipedia.org/w/index.php?title=Template:Computer-security-stub&action=edit","//en.wikipedia.org/w/index.php?title=Special:CentralAutoLogin/start&type=1x1&from=enwiki","http://en.wikipedia.org/w/index.php?title=JIT_spraying&oldid=565350646","/wiki/Help:Categories","/wiki/Category:Computer_security_stubs","/wiki/Category:Computer_security_exploits","/wiki/Category:Use_dmy_dates_from_December_2012","/w/index.php?title=Special:UserLogin&returnto=JIT+spraying&type=signup","/w/index.php?title=Special:UserLogin&returnto=JIT+spraying","/wiki/JIT_spraying","/wiki/Talk:JIT_spraying","#","/wiki/JIT_spraying","/w/index.php?title=JIT_spraying&action=edit","/w/index.php?title=JIT_spraying&action=history","#","/w/index.php","//bits.wikimedia.org/static-1.22wmf10/skins/vector/images/search-ltr.png?303-4","/wiki/Main_Page","/wiki/Main_Page","/wiki/Portal:Contents","/wiki/Portal:Featured_content","/wiki/Portal:Current_events","/wiki/Special:Random","//donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&utm_medium=sidebar&utm_campaign=C13_en.wikipedia.org&uselang=en","/wiki/Help:Contents","/wiki/Wikipedia:About","/wiki/Wikipedia:Community_portal","/wiki/Special:RecentChanges","//en.wikipedia.org/wiki/Wikipedia:Contact_us","/wiki/Special:WhatLinksHere/JIT_spraying","/wiki/Special:RecentChangesLinked/JIT_spraying","/wiki/Wikipedia:File_Upload_Wizard","/wiki/Special:SpecialPages","/w/index.php?title=JIT_spraying&oldid=565350646","/w/index.php?title=JIT_spraying&action=info","//www.wikidata.org/wiki/Q6108270","/w/index.php?title=Special:Cite&page=JIT_spraying&id=565350646","/w/index.php?title=Special:Book&bookcmd=book_creator&referer=JIT+spraying","/w/index.php?title=Special:Book&bookcmd=render_article&arttitle=JIT+spraying&oldid=565350646&writer=rl","/w/index.php?title=JIT_spraying&printable=yes","#","//www.wikidata.org/wiki/Q6108270#sitelinks-wikipedia","//en.wikipedia.org/wiki/Wikipedia:Text_of_Creative_Commons_Attribution-ShareAlike_3.0_Unported_License","//creativecommons.org/licenses/by-sa/3.0/","//wikimediafoundation.org/wiki/Terms_of_Use","//wikimediafoundation.org/wiki/Privacy_policy","//www.wikimediafoundation.org/","//wikimediafoundation.org/wiki/Privacy_policy","/wiki/Wikipedia:About","/wiki/Wikipedia:General_disclaimer","//en.wikipedia.org/wiki/Wikipedia:Contact_us","//en.m.wikipedia.org/wiki/JIT_spraying","//wikimediafoundation.org/","//bits.wikimedia.org/images/wikimedia-button.png","//www.mediawiki.org/","//bits.wikimedia.org/static-1.22wmf10/skins/common/images/poweredby_mediawiki_88x31.png","//bits.wikimedia.org/en.wikipedia.org/load.php?debug=false&lang=en&modules=site&only=scripts&skin=vector&*"],"instances":[],"pdf":["http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf","http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Slides-v2.pdf"],"categories":["Computer security exploits"],"headings":["References"],"image":["//upload.wikimedia.org/wikipedia/commons/thumb/7/73/Monitor_padlock.svg/40px-Monitor_padlock.svg.png","//en.wikipedia.org/w/index.php?title=Special:CentralAutoLogin/start&type=1x1&from=enwiki","//bits.wikimedia.org/static-1.22wmf10/skins/vector/images/search-ltr.png?303-4","//bits.wikimedia.org/images/wikimedia-button.png","//bits.wikimedia.org/static-1.22wmf10/skins/common/images/poweredby_mediawiki_88x31.png"],"tags":[],"members":[],"related":["Computer_security_exploit","Address_space_randomization","Data_execution_prevention","Just-in-time_compilation","PDF","Adobe_Flash","Just-in-time_compiler","Heap_spraying","JavaScript","ActionScript","XOR","Buffer_overflow","Use_after_free","Function_pointer","Return_address","Return-oriented_programming","X86","X86-64","ARM_architecture"]}